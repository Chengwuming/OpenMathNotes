<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>笔记更新记录</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f4f4f4;
        }
        .timeline-container {
            width: 80%;
            max-width: 800px;
            overflow: hidden;
            position: relative;
            height: 600px;
            border: 1px solid #ccc;
            padding: 20px;
            box-sizing: border-box;
            background-color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .timeline {
            position: relative;
            padding: 0;
            margin: 0;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .timeline::after {
            content: '';
            position: absolute;
            width: 6px;
            background-color: #ccc;
            top: 0;
            bottom: 0;
            left: 50%;
            margin-left: -3px;
        }
        .container {
            padding: 10px 40px;
            position: relative;
            background-color: inherit;
            width: 50%;
            opacity: 0.7;
            transform: scale(0.8);
            transition: all 0.5s ease;
        }
        .container::after {
            content: '';
            position: absolute;
            width: 25px;
            height: 25px;
            right: -17px;
            background-color: white;
            border: 4px solid #FF9F55;
            top: 15px;
            border-radius: 50%;
            z-index: 1;
        }
        .left {
            left: 0;
        }
        .right {
            left: 50%;
        }
        .left::before {
            content: " ";
            height: 0;
            position: absolute;
            top: 22px;
            width: 0;
            z-index: 1;
            right: 30px;
            border: medium solid white;
            border-width: 10px 0 10px 10px;
            border-color: transparent transparent transparent white;
        }
        .right::before {
            content: " ";
            height: 0;
            position: absolute;
            top: 22px;
            width: 0;
            z-index: 1;
            left: 30px;
            border: medium solid white;
            border-width: 10px 10px 10px 0;
            border-color: transparent white transparent transparent;
        }
        .right::after {
            left: -16px;
        }
        .content {
            padding: 20px 30px;
            background-color: white;
            position: relative;
            border-radius: 6px;
            border: 1px solid #ccc;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .content h2 {
            margin: 0;
            font-size: 1.5em;
        }
        .content p {
            margin: 5px 0;
        }
        .container.active {
            opacity: 1;
            transform: scale(1);
        }
    </style>
</head>
<body>
    <h1>笔记更新记录</h1>
    <div class="timeline-container" id="notes-container"></div>

    <script>
        async function fetchRSS() {
            const response = await fetch('lib/rss.xml'); // 修改这里
            const text = await response.text();
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(text, 'text/xml');

            const items = Array.from(xmlDoc.querySelectorAll('item'));

            // 按发布日期排序
            items.sort((a, b) => {
                const dateA = new Date(a.querySelector('pubDate').textContent);
                const dateB = new Date(b.querySelector('pubDate').textContent);
                return dateB - dateA; // 降序排序
            });

            const notesContainer = document.getElementById('notes-container');
            let currentDate = null;

            const timeline = document.createElement('div');
            timeline.className = 'timeline';

            items.forEach((item, index) => {
                const title = item.querySelector('title').textContent;
                const link = item.querySelector('link').textContent;
                const description = item.querySelector('description').textContent;
                const pubDate = item.querySelector('pubDate').textContent;

                // 提取预览内容
                const previewMatch = description.match(/"(.*?)"/);
                const previewContent = previewMatch ? previewMatch[1].trim() : '无预览内容';

                // 获取发布日期
                const date = new Date(pubDate).toLocaleDateString();

                // 如果日期变化，创建新的日期标题
                if (date !== currentDate) {
                    currentDate = date;
                    const dateHeader = document.createElement('h2');
                    dateHeader.textContent = date;
                    timeline.appendChild(dateHeader);
                }

                const container = document.createElement('div');
                container.className = index % 2 === 0 ? 'container left' : 'container right';

                const content = document.createElement('div');
                content.className = 'content';

                const postTitleLink = document.createElement('a');
                postTitleLink.href = link;

                const postTitle = document.createElement('h2');
                postTitle.className = 'post-title';
                postTitle.textContent = title;

                const postMeta = document.createElement('p');
                postMeta.className = 'post-meta';
                postMeta.textContent = `Updated on ${new Date(pubDate).toLocaleString()}`;

                const postDescription = document.createElement('p');
                postDescription.textContent = previewContent;

                postTitleLink.appendChild(postTitle);
                content.appendChild(postTitleLink);
                content.appendChild(postMeta);
                content.appendChild(postDescription);

                container.appendChild(content);
                timeline.appendChild(container);
            });

            notesContainer.appendChild(timeline);

            // 添加滚动事件监听器
            notesContainer.addEventListener('scroll', () => {
                const containers = document.querySelectorAll('.container');
                containers.forEach(container => {
                    const rect = container.getBoundingClientRect();
                    const containerCenter = rect.top + rect.height / 2;
                    const containerActive = containerCenter >= 0 && containerCenter <= notesContainer.clientHeight;
                    if (containerActive) {
                        container.classList.add('active');
                    } else {
                        container.classList.remove('active');
                    }
                });
            });

            // 初始化时触发一次滚动事件
            notesContainer.dispatchEvent(new Event('scroll'));
        }

        fetchRSS();
    </script>
</body>
</html>